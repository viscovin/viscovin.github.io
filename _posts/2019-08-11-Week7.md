---
layout: post
title: Week 7
---
# Web Security

### Web as a Delivery Mechanism

Mosaic: one of the first browsers to be used (1993)  
Some of the attacks we learn about today may not work today. Things evolve very fast and 95% of malware is delivered via the web.

<img src= "https://raw.githubusercontent.com/viscovin/viscovin.github.io/master/images/evolution.JPG">

**Injection Points**
- HTTP: HTTP Proxy Network Layer 
- HTML (Raw HTML): WinInet ETW/ETL
- HTML (DOM Tree): Browser/Extensions
- Javascript: Script Engine
- De-Obfuscated Content: Browser/Extensions

### User Level Attacks
**- Social Engineering:** In the context of information security, refers to psychological manipulation of people into performing actions or divulging confidential information. A type of confidence trick for the purpose of information gathering, fraud, or system access, it differs from a traditional "con" in that it is often one of many steps in a more complex fraud scheme.

**Users ARE the weak link**
- Hardened/current browser/OS will not help.
- Exploit common user traits
    - Impatient
    - Lazy
    - Self-proclaimed omniscience
    - Clickaholic
**Direct the user to malicious content through their own actions**
- Executables
- Browser exploits
- Malicious forms

#### Phishing
- Not just restricted to banking/financial anymore
- URLs not always delivered via email.
- Spear phishing, social media, and snowshoe spam continues to keep it alive.
- Valid SSL cert does not always protect the user.
- Sites are very short-lived

#### SEO Poisoning
- Identify trends using available tools such as Google Trends
- Use search results to lure the web-searching victim.
    - Celebrities
    - Pop Culture
    - World Events
    - Educational/Professional
    - Fake AV/AM
- Game the search engine’s relevance rules
    - Related content
    - Massive inbound linking
    - Relevant inbound linking
- Site redirects to malicious content

#### Fake Updates & Fake Antivirus
- Preys on user’s good intentions.
- Often mimics OS-level UI components.
- Sometimes mimics well-known security brands.
- May deliver malware
- May deliver absolutely nothing for the low cost of $49.99. If you act now.

#### WYSIWYG (What You See is What You Get)
- URL Obfuscation makes suspicious URLs look legitimate
    - URL shortening services
    - Homographic attacks
        - ASCII – http://www.rnicrosoft.com/en-us/download/
        - ASCII – http://www.arnazon.com/prime/
        - ASCII – http://I92.I68.0.I
        - ASCII – http://oregonstate.ecIu
- IDN – http://paypаl.com (internationalized domain name)
    - (http://xn--paypl-7ve.com)

#### Social Media Attacks
- Social media: A gift to malware authors
    - Anti-spam systems have become very effective.
    - Social media opens a new world for malicious URL delivery and information gathering

I saw the link on the Facebook and Twitter,so it must be OK, right?
Have you Google or Facebook searched your lecturers?
Who ever heard of “Robin Sage”?
Who has already been Catfished?

#### Malvertising
- Malicious actor uses advertising networks as delivery mechanism for malware.
- Does not require any web site or hosting provider compromise.
- Very dangerous, as most end users implicitly trust content on high-profile, popular, and known sites.

<img src= "https://raw.githubusercontent.com/viscovin/viscovin.github.io/master/images/malvertising.JPG">

#### Waterhole Attack
- With closed OSes and application signing, developers have become a prime target
- An easy way to target developers is to hack a resource (forum for example) known to be used by a community of developers

### Common Defenses for User Attacks
- URL/Domain Reputation Systems
    - Real-time protection in browser or network device.
    - Search result link annotation
- Site Certification Services
- Client and Gateway AV/AM
- Safe URL Shorteners
- Content provider education
    - Banks love to train their customers to be phishing victims.
    - Brand monitoring services
- End user education

### Browser Level Attacks
#### Security Features of Modern Web Browsers
- Content Security Policy Enforcement
    - Same Origin Policy (SOP)
        - DOM
        - XMLHTTPRequest
        - Cookies
        - Flash
        - Java
    - Cross Origin Resource Sharing (CORS)
- URL Scheme Access Rules
- OS Isolation/Sandboxing
- Redirection Restrictions
- Content handling/sniffing
- Disruptive Script Handling
- Built-in and Plug-in URL Reputation Client
- Add-on AV/AM Content Monitoring

**The Browser Exploit**
- Browser downloads, renders and executes maliciously crafted web content.
- Exploits vulnerabilities in the browser
    - Known
    - Unknown, AKA “Zero Day”
    - Often executes shellcode via the browser script engine.
- Typically a multi-step process
    - Lure user to site
        - User-initiated
        - Drive-by
    - Exploit browser
    - Download/Execute actual payload
        - Payload can be any malware, does not need to be web-centric.


